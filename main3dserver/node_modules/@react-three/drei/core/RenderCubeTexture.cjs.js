"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@babel/runtime/helpers/extends"),r=require("three"),t=require("react"),n=require("@react-three/fiber");function a(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function i(e){if(e&&e.__esModule)return e;var r=Object.create(null);return e&&Object.keys(e).forEach((function(t){if("default"!==t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})}})),r.default=e,Object.freeze(r)}var u=a(e),o=i(r),c=i(t);const s=c.forwardRef((({children:e,compute:r,renderPriority:t=-1,eventPriority:a=0,frames:i=1/0,stencilBuffer:s=!1,depthBuffer:l=!0,generateMipmaps:p=!1,resolution:m=896,near:d=.1,far:b=1e3,flip:h=!1,position:g,rotation:x,scale:y,quaternion:v,matrix:P,matrixAutoUpdate:j,...E},O)=>{const{size:w,viewport:q}=n.useThree(),M=c.useRef(null),T=c.useMemo((()=>{const e=new o.WebGLCubeRenderTarget(Math.max((m||w.width)*q.dpr,(m||w.height)*q.dpr),{stencilBuffer:s,depthBuffer:l,generateMipmaps:p});return e.texture.isRenderTargetTexture=!h,e.texture.flipY=!0,e.texture.type=o.HalfFloatType,e}),[m,h]);c.useEffect((()=>()=>T.dispose()),[T]);const[C]=c.useState((()=>new o.Scene)),F=c.useCallback(((e,r,t)=>{r.pointer.set(e.offsetX/r.size.width*2-1,-e.offsetY/r.size.height*2+1),r.raycaster.setFromCamera(r.pointer,r.camera)}),[]);return c.useImperativeHandle(O,(()=>({scene:C,fbo:T,camera:M.current})),[T]),c.createElement(c.Fragment,null,n.createPortal(c.createElement(f,{renderPriority:t,frames:i,camera:M},e,c.createElement("group",{onPointerOver:()=>null})),C,{events:{compute:r||F,priority:a}}),c.createElement("primitive",u.default({object:T.texture},E)),c.createElement("cubeCamera",{ref:M,args:[d,b,T],position:g,rotation:x,scale:y,quaternion:v,matrix:P,matrixAutoUpdate:j}))}));function f({frames:e,renderPriority:r,children:t,camera:a}){let i=0;return n.useFrame((r=>{(e===1/0||i<e)&&(a.current.update(r.gl,r.scene),i++)}),r),c.createElement(c.Fragment,null,t)}exports.RenderCubeTexture=s;
